{"componentChunkName":"component---src-templates-post-template-post-template-tsx","path":"/posts/build_chromium_firefox","result":{"data":{"markdownRemark":{"id":"a4eda54e-77f0-5cc1-ab08-06fe1668a013","html":"<h2 id=\"preface\" style=\"position:relative;\"><a href=\"#preface\" aria-label=\"preface permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Preface</h2>\n<p>Build project from source code is always an interesting stuff. This blog is about how to build chromium and firefox from source code.</p>\n<p>Note: Actuallt it’s not a blog, it’s a small guidance for how to get through the whole workflow (Especially in some regions requiring proxy or VPN to access the chromium source code repository.)</p>\n<h2 id=\"build-chromium-from-source-code\" style=\"position:relative;\"><a href=\"#build-chromium-from-source-code\" aria-label=\"build chromium from source code permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Build chromium from source code</h2>\n<h2 id=\"reference-links\" style=\"position:relative;\"><a href=\"#reference-links\" aria-label=\"reference links permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Reference Links</h2>\n<p>The guidance is edited from an internal wiki page. Tried several times, very useful. Before the main content, here are some useful official links for Chromium project:</p>\n<p>Here is the official link for building chromium on different platforms:\n<a href=\"https://www.chromium.org/developers/how-tos/get-the-code\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">The Chromium Projects</a></p>\n<p>Official Guidance for building Chromium for Windows (A little verbose and more universal):\n<a href=\"https://chromium.googlesource.com/chromium/src/+/master/docs/windows_build_instructions.md\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Build Chromium on Windows</a></p>\n<p><a href=\"https://bitbucket.org/chromiumembedded/cef/src/master/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Chromium Embedded Framework, CEF</a> is a project for maintaining different branches of chromium source code and related work of chromium itself.</p>\n<p>Here are 3 links that’s useful in building chromium from the CEF project:</p>\n<p>It’s a wrap-up link for setting up on different OS.\n<a href=\"https://bitbucket.org/chromiumembedded/cef/wiki/MasterBuildQuickStart.md\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Build QuickStart</a></p>\n<p>A description which involves more details in environment variables and related configuration (on Windows).\n<a href=\"https://bitbucket.org/chromiumembedded/cef/wiki/AutomatedBuildSetup.md#markdown-header-windows-configuration\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Build Setup</a></p>\n<h2 id=\"guidance\" style=\"position:relative;\"><a href=\"#guidance\" aria-label=\"guidance permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Guidance</h2>\n<h3 id=\"pre-requisites\" style=\"position:relative;\"><a href=\"#pre-requisites\" aria-label=\"pre requisites permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Pre-requisites</h3>\n<table>\n<thead>\n<tr>\n<th>Actions</th>\n<th>Remark</th>\n<th>Reference</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><strong>Install Visual Studio</strong></td>\n<td>Community Edition has met the reuqirement. Note for the installation:</td>\n<td><a href=\"https://chromium.googlesource.com/chromium/src/+/master/docs/windows_build_instructions.md\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Chromium Offical Docs</a></td>\n</tr>\n<tr>\n<td></td>\n<td>1. Desktop development with C++ (including <strong>MFC and   ATL support</strong>)</td>\n<td></td>\n</tr>\n<tr>\n<td></td>\n<td>2. Install Windows 10 SDK installed, latest version is preferred</td>\n<td></td>\n</tr>\n<tr>\n<td><strong>Setup depot_tools</strong></td>\n<td><a href=\"http://commondatastorage.googleapis.com/chrome-infra-docs/flat/depot_tools/docs/html/depot_tools.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">depot_tools</a> is a tool for maintaing the source (Cubersome to use)</td>\n<td><a href=\"http://commondatastorage.googleapis.com/chrome-infra-docs/flat/depot_tools/docs/html/depot_tools_tutorial.html#_setting_up\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">depot_tools Doc</a></td>\n</tr>\n<tr>\n<td>Add depot_tools to path (system environment variable on Win)</td>\n<td>Unzip the folder, or you can git clone the <a href=\"https://chromium.googlesource.com/chromium/tools/depot_tools.git\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">repository</a></td>\n<td>Add it to the system variables in case</td>\n</tr>\n<tr>\n<td>Add system environment variable <strong>DEPOT_TOOLS_WIN_TOOLCHAIN: 0</strong></td>\n<td>SET DEPOT_TOOLS_WIN_TOOLCHAIN=0</td>\n<td><a href=\"https://chromium.googlesource.com/chromium/src/+/master/docs/windows_build_instructions.md\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Chromium Guide</a></td>\n</tr>\n<tr>\n<td>Add system environment variables <strong>GYP_GENERATORS</strong> &#x26; <strong>GYP_MSVS_VERSION</strong></td>\n<td>SET GYP_GENERATORS=msvs-ninja,ninja</td>\n<td></td>\n</tr>\n<tr>\n<td></td>\n<td>SET GYP_MSVS_VERSION=2019 (if you use other versions please chnage)</td>\n<td></td>\n</tr>\n</tbody>\n</table>\n<p>These are environment settings for preparations of building chromium on Windows.</p>\n<h3 id=\"build-chromium\" style=\"position:relative;\"><a href=\"#build-chromium\" aria-label=\"build chromium permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Build Chromium</h3>\n<p>After installing the Visual Studio and setting the environment variables, next step is to fetch the source code from Chromium source code repository. The following table is a detailed instruction (Note: ** Follow the step exactly one by one, especially setting the proxy **)</p>\n<table>\n<thead>\n<tr>\n<th>Phase</th>\n<th>Run Command &#x26; Operations</th>\n<th>Running Path</th>\n<th>Remark</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><strong>Prepare</strong></td>\n<td>netsh winhttp set proxy <a href=\"url:port\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">url:port</a></td>\n<td></td>\n<td><strong>Run the command in CMD</strong> in case did not work</td>\n</tr>\n<tr>\n<td></td>\n<td>git config —global user.name <your name></td>\n<td></td>\n<td>Set your git use info</td>\n</tr>\n<tr>\n<td></td>\n<td>git config —global user.email <your email></td>\n<td></td>\n<td>Set your git use info</td>\n</tr>\n<tr>\n<td></td>\n<td>git config —global http.proxy <a href=\"url:port\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">url:port</a></td>\n<td></td>\n<td>Set git proxy</td>\n</tr>\n<tr>\n<td></td>\n<td>git config —global https.proxy <a href=\"url:port\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">url:port</a></td>\n<td></td>\n<td>Note: when set https proxy, use <strong>http://</strong> ,do not use https://</td>\n</tr>\n<tr>\n<td></td>\n<td>set HTTP_PROXY=<a href=\"url:port\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">url:port</a></td>\n<td></td>\n<td>Set global proxy</td>\n</tr>\n<tr>\n<td></td>\n<td>set HTTPS_PROXY=<a href=\"url:port\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">url:port</a></td>\n<td></td>\n<td>when set https proxy, use <strong>http://</strong> ,do not use https://</td>\n</tr>\n<tr>\n<td></td>\n<td>set SOCKS5_PROXY=<a href=\"url:port\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">url:port</a></td>\n<td></td>\n<td><strong>Compulsory.If SOCKS5 is not set, will encounter problems when running scripts in depot_tools</strong></td>\n</tr>\n<tr>\n<td><strong>BOTO config</strong></td>\n<td>This step is also to create the proxy.</td>\n<td></td>\n<td></td>\n</tr>\n<tr>\n<td></td>\n<td>Create a file with extension “.boto”, e.g. proxy_config.boto</td>\n<td></td>\n<td></td>\n</tr>\n<tr>\n<td></td>\n<td>The BOTO content:</td>\n<td></td>\n<td></td>\n</tr>\n<tr>\n<td></td>\n<td>[Boto]</td>\n<td></td>\n<td>Save the file somewhere you like, for example, C:\\proxy_config.boto</td>\n</tr>\n<tr>\n<td></td>\n<td>proxy=&#x3C;proxy_url></td>\n<td></td>\n<td></td>\n</tr>\n<tr>\n<td></td>\n<td>proxy_port=&#x3C;proxy_port></td>\n<td></td>\n<td></td>\n</tr>\n<tr>\n<td></td>\n<td><strong>SET NO_AUTH_BOTO_CONFIG=C:\\proxy_config.boto</strong></td>\n<td></td>\n<td>In Windows, add a new variable in system environment variables.</td>\n</tr>\n<tr>\n<td><strong>Running gclient</strong></td>\n<td>gclient</td>\n<td></td>\n<td><strong>Run the command in CMD</strong>, it will install an individual python and other tools.</td>\n</tr>\n<tr>\n<td><strong>Fetch Master</strong></td>\n<td>fetch chromium</td>\n<td>Parent directory of chromium src directory</td>\n<td>Download the source code from master, may take a very long time, depending on the internet connection.</td>\n</tr>\n<tr>\n<td><strong>Update Master</strong></td>\n<td>git checkout master</td>\n<td>chromium src directory</td>\n<td></td>\n</tr>\n<tr>\n<td></td>\n<td>git pull</td>\n<td>chromium src directory</td>\n<td>pull changes list</td>\n</tr>\n<tr>\n<td></td>\n<td>gclient sync</td>\n<td>chromium src directory</td>\n<td>synchronize dependencies and third parties</td>\n</tr>\n<tr>\n<td><strong>Switch to working branch</strong></td>\n<td>git checkout -b <local branch name> <tag name></td>\n<td>chromium src directory</td>\n<td>example: git checkout -b Chromium_39.0.2171.71 39.0.2171.71. Go to <a href=\"http://www.chromium.org/developers/calendar\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Chrome Calendar</a> to find latest stable branch (tag), in “Current Release Information”, win, stable, current_version</td>\n</tr>\n<tr>\n<td></td>\n<td></td>\n<td></td>\n<td>Note: you may need to run <strong>“git fetch —tags”</strong> to fetch all tags first</td>\n</tr>\n<tr>\n<td></td>\n<td>gclient sync —with_branch_heads —jobs 16</td>\n<td>chromium src directory</td>\n<td>to sync all solution related code, dependencies and third parties of current branch</td>\n</tr>\n<tr>\n<td><strong>Generate solution file</strong></td>\n<td>gn args out/<build name></td>\n<td>chromium src directory</td>\n<td>for example: gn args out/Default</td>\n</tr>\n<tr>\n<td></td>\n<td></td>\n<td></td>\n<td>in the opened editor, set at least following build args.</td>\n</tr>\n<tr>\n<td></td>\n<td></td>\n<td></td>\n<td><strong>is_debug=false</strong></td>\n</tr>\n<tr>\n<td></td>\n<td></td>\n<td></td>\n<td><strong>target_cpu=“x64”</strong></td>\n</tr>\n<tr>\n<td></td>\n<td></td>\n<td></td>\n<td>See <a href=\"https://chromium.googlesource.com/chromium/src/+/master/tools/gn/docs/quick_start.md\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">parameters</a></td>\n</tr>\n<tr>\n<td><strong>Build solution</strong></td>\n<td>ninja -C out&#x3C;build name> chrome</td>\n<td>chromium src directory</td>\n<td>build x64 bit to src\\out&#x3C;build name> folder, could take 4 hours</td>\n</tr>\n<tr>\n<td></td>\n<td></td>\n<td>See <a href=\"https://chromium.googlesource.com/chromium/src/+/master/docs/windows_build_instructions.md\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">build instructions</a></td>\n<td></td>\n</tr>\n<tr>\n<td></td>\n<td></td>\n<td>Note: you may need to add “C:\\Program Files (x86)\\Windows Kits\\10\\Include\\10.0.16299.0\\um” to PATH system environment variable</td>\n<td></td>\n</tr>\n<tr>\n<td></td>\n<td></td>\n<td>Note: you may need to modify <strong>“out\\Default\\environment.x64”</strong> file, changing all 10.0.15063.0 to 10.0.16299.0 (for correct Win SDK version).</td>\n<td></td>\n</tr>\n</tbody>\n</table>\n<h2 id=\"build-firefox-from-source-code\" style=\"position:relative;\"><a href=\"#build-firefox-from-source-code\" aria-label=\"build firefox from source code permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Build FireFox from source code</h2>\n<p>Build from FireFox from source code is pretty easier.</p>\n<h3 id=\"reference-links-1\" style=\"position:relative;\"><a href=\"#reference-links-1\" aria-label=\"reference links 1 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Reference Links</h3>\n<p>Here is the link for buidling Firefox on Windows (won’t paste the content here, just follow the instructions):</p>\n<p><a href=\"https://firefox-source-docs.mozilla.org/setup/windows_build.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Build FireFox on Windows</a></p>\n<p>Remarks on the note:</p>\n<ol>\n<li>Install Python 3.x and Python 2.7 (not sure why the script still requires Python2 dependency, and set the environment variables on Windows if multiple versions of Python did not work as expected )</li>\n<li>When set the system proxy, remember to set the following:\n<ul>\n<li>http proxy</li>\n<li>https proxy (when set https proxy, use http://your_proxy removing ‘s’)</li>\n<li>socks5 proxy (crucial)</li>\n</ul>\n</li>\n<li>If the toolchain ‘mach’ failed on certain steps, just perform some other actions.</li>\n</ol>\n<h3 id=\"building-old-versions-firefox\" style=\"position:relative;\"><a href=\"#building-old-versions-firefox\" aria-label=\"building old versions firefox permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Building Old Versions FireFox</h3>\n<p>(This section is added on 2021/04/08 ) When build FireFox with some lower versions, there are several problems I have seen:</p>\n<ol>\n<li>The Rust version is not compatiable</li>\n<li>The script (Mainly in Python, for the purpose to update) needs to sync with the server and check the versions.</li>\n</ol>","fields":{"slug":"/posts/build_chromium_firefox//posts/build_chromium_firefox","tagSlugs":["/tag/tech/","/tag/en/"]},"frontmatter":{"date":"2021-03-17","description":"This blog is a note recording the problems met when building chromium and firefox from source code.","tags":["tech","EN"],"title":"Build Chromium and FireFox from Source Code (Windows as Example)","socialImage":null}}},"pageContext":{"slug":"/posts/build_chromium_firefox//posts/build_chromium_firefox"}},"staticQueryHashes":["251939775","2764776372","401334301"]}